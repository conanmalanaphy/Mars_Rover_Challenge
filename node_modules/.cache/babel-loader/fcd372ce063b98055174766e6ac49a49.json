{"ast":null,"code":"var _jsxFileName = \"/home/conan/mars_rover/src/App.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useReducer } from \"react\";\nimport \"./App.css\";\nimport rover from \"./Rover\";\nimport Papa from \"papaparse\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction reducer(state, action) {\n  switch (action.type) {\n    case \"loaded_rovers\":\n      return { ...state,\n        roversLeft: action.payload\n      };\n\n    case \"change_rovers\":\n      return { ...state,\n        roversLeft: [...state.roversLeft.slice(1)],\n        existingRoversPosition: [...state.existingRoversPosition, action.payload]\n      };\n  }\n}\n\nconst CSV_ADDRESS = \"rover_instructions.csv\";\n\nfunction App() {\n  _s();\n\n  // Define how big the terrian will be\n  const maxTerrainSize = {\n    x: 5,\n    y: 5\n  };\n  const [{\n    existingRoversPosition,\n    roversLeft\n  }, dispatch] = useReducer(reducer, {\n    existingRoversPosition: [],\n    roversLeft: []\n  });\n  useEffect(() => {\n    async function fetchCsv() {\n      const response = await fetch(CSV_ADDRESS);\n\n      if (response.body != null) {\n        const reader = response.body.getReader();\n        const result = await reader.read();\n        const decoder = new TextDecoder(\"utf-8\");\n        const csv = await decoder.decode(result.value);\n        Papa.parse(csv, {\n          skipEmptyLines: true,\n          complete: ({\n            data\n          }) => {\n            const aa = data.map(data => {\n              const [x, y, direction] = data[0].substring(1).split(\" \");\n              const mainCommands = data[1].slice(1, -1).split(\"\");\n              return {\n                initialPosition: {\n                  x: parseInt(x),\n                  y: parseInt(y),\n                  direction: direction\n                },\n                commands: mainCommands\n              };\n            });\n            dispatch({\n              type: \"loaded_rovers\",\n              payload: aa\n            });\n          }\n        });\n      }\n    }\n\n    fetchCsv();\n  }, []);\n  useEffect(() => {\n    //After Processing the first Rover we can move on to the next one\n    if (roversLeft.length > 0) {\n      const currentRover = roversLeft[0];\n      const roverFinalPosition = rover(maxTerrainSize, currentRover.initialPosition, currentRover.commands, existingRoversPosition);\n      dispatch({\n        type: \"change_rovers\",\n        payload: roverFinalPosition\n      });\n    }\n  }, [roversLeft, existingRoversPosition, maxTerrainSize]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"App\",\n    children: [...Array(maxTerrainSize.x)].map((e, i) => {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"container\",\n        children: [...Array(maxTerrainSize.y)].map((e, j) => {\n          const roverHere = existingRoversPosition.findIndex(rover => {\n            return rover.x === i && rover.y === j;\n          });\n          return roverHere !== -1 ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"item item2\",\n            children: [\"Rover \", roverHere + 1]\n          }, `row-${i}-col-${j}`, true, {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \" item \",\n            children: \"\\xA0\"\n          }, `row-${i}-col-${j}`, false, {\n            fileName: _jsxFileName,\n            lineNumber: 118,\n            columnNumber: 17\n          }, this);\n        })\n      }, `row-${i}`, false, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 11\n      }, this);\n    })\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 105,\n    columnNumber: 5\n  }, this);\n}\n\n_s(App, \"xcfIFu9ozLAMWCofSJumnmxKTRQ=\");\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"sources":["/home/conan/mars_rover/src/App.tsx"],"names":["React","useEffect","useReducer","rover","Papa","reducer","state","action","type","roversLeft","payload","slice","existingRoversPosition","CSV_ADDRESS","App","maxTerrainSize","x","y","dispatch","fetchCsv","response","fetch","body","reader","getReader","result","read","decoder","TextDecoder","csv","decode","value","parse","skipEmptyLines","complete","data","aa","map","direction","substring","split","mainCommands","initialPosition","parseInt","commands","length","currentRover","roverFinalPosition","Array","e","i","j","roverHere","findIndex"],"mappings":"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","sourcesContent":["import React, { Reducer, useEffect, useReducer } from \"react\";\nimport \"./App.css\";\nimport rover from \"./Rover\";\nimport { Command, Direction, Rovers } from \"./rover.types\";\nimport Papa from \"papaparse\";\n\ninterface UndeployedRover {\n  initialPosition: Rovers;\n  commands: Command[];\n}\n\ntype State = {\n  existingRoversPosition: Rovers[];\n  roversLeft: UndeployedRover[];\n};\n\ntype Action =\n  | { type: \"loaded_rovers\"; payload: UndeployedRover[] }\n  | { type: \"change_rovers\"; payload: Rovers };\n\nfunction reducer(state: State, action: Action): State {\n  switch (action.type) {\n    case \"loaded_rovers\":\n      return {\n        ...state,\n        roversLeft: action.payload,\n      };\n    case \"change_rovers\":\n      return {\n        ...state,\n        roversLeft: [...state.roversLeft.slice(1)],\n        existingRoversPosition: [\n          ...state.existingRoversPosition,\n          action.payload,\n        ],\n      };\n  }\n}\nconst CSV_ADDRESS = \"rover_instructions.csv\";\nfunction App() {\n  // Define how big the terrian will be\n  const maxTerrainSize = { x: 5, y: 5 };\n\n  const [{ existingRoversPosition, roversLeft }, dispatch] = useReducer<\n    Reducer<State, Action>\n  >(reducer, {\n    existingRoversPosition: [],\n    roversLeft: [],\n  });\n\n  useEffect(() => {\n    async function fetchCsv() {\n      const response = await fetch(CSV_ADDRESS);\n\n      if (response.body != null) {\n        const reader = response.body.getReader();\n        const result = await reader.read();\n        const decoder = new TextDecoder(\"utf-8\");\n        const csv = await decoder.decode(result.value);\n\n        Papa.parse(csv, {\n          skipEmptyLines: true,\n          complete: ({ data }) => {\n            const aa = data.map((data: any) => {\n              const [x, y, direction] = data[0].substring(1).split(\" \");\n              const mainCommands = data[1].slice(1, -1).split(\"\");\n\n              return {\n                initialPosition: {\n                  x: parseInt(x),\n                  y: parseInt(y),\n                  direction: direction as Direction,\n                },\n                commands: mainCommands as Command[],\n              };\n            });\n            dispatch({\n              type: \"loaded_rovers\",\n              payload: aa as UndeployedRover[],\n            });\n          },\n        });\n      }\n    }\n    fetchCsv();\n  }, []);\n\n  useEffect(() => {\n    //After Processing the first Rover we can move on to the next one\n    if (roversLeft.length > 0) {\n      const currentRover = roversLeft[0];\n\n      const roverFinalPosition = rover(\n        maxTerrainSize,\n        currentRover.initialPosition,\n        currentRover.commands,\n        existingRoversPosition\n      );\n\n      dispatch({ type: \"change_rovers\", payload: roverFinalPosition });\n    }\n  }, [roversLeft, existingRoversPosition, maxTerrainSize]);\n\n  return (\n    <div className=\"App\">\n      {[...Array(maxTerrainSize.x)].map((e, i) => {\n        return (\n          <div className=\"container\" key={`row-${i}`}>\n            {[...Array(maxTerrainSize.y)].map((e, j) => {\n              const roverHere = existingRoversPosition.findIndex((rover) => {\n                return rover.x === i && rover.y === j;\n              });\n              return roverHere !== -1 ? (\n                <div className=\"item item2\" key={`row-${i}-col-${j}`}>\n                  Rover {roverHere + 1}\n                </div>\n              ) : (\n                <div className=\" item \" key={`row-${i}-col-${j}`}>\n                  &nbsp;\n                </div>\n              );\n            })}\n          </div>\n        );\n      })}\n    </div>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}